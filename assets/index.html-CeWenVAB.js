import{_ as e,c as h,a as i,b as t,d as a,e as l,w as p,r as k,o as d}from"./app-WIG124Xj.js";const r="/assets/1729269036825-964666db-f75b-40ac-8793-c3da937cb5ed-BWcdHW95.png",g="/assets/1729309289276-6078d0dd-0ac1-4d1a-ba50-0756f0727bf0-Dz-P7pOu.png",c="/assets/1729312378028-18cdb021-65d0-4786-bca3-c65c488fa308-DDasRNek.png",y="/assets/1729312910908-364bab6b-9561-48f1-a956-a932ad6dd0e1-Bq9Yo3wm.png",A="/assets/1729313206384-cddbb27b-51dd-4894-a895-afee54ae4951-CCAhLnme.png",o="/assets/1729313250549-bfc7bad9-d24a-4a00-a8ac-467d08891e07-DZUyQ7S6.png",B="/assets/1729315832388-5f29c0ff-ec19-40c7-b914-c824e0fae9c1-BDFw5kpg.png",v="/assets/1729316846258-0ab72f80-f6ac-4d9f-8a17-2ea3c743cd85-L_0sa2Na.png",m="/assets/1729317800147-7c0b8dda-3263-4139-a0aa-9569c4202196-C303QyML.png",D={};function u(b,s){const n=k("font");return d(),h("div",null,[s[2]||(s[2]=i('<h2 id="写在前面" tabindex="-1"><a class="header-anchor" href="#写在前面"><span>写在前面</span></a></h2><p>如果想让局域网的个人网站能够在公网访问，就必须要公网地址，目前公网 IPV4 地址个人难以申请，但 IPV6 地址使用门槛就非常低，几乎都是支持的。</p><p>本篇文章就接着<a href="https://blog.ifback.com/article/android-phone-deploy-personal-website-by-termux/" target="_blank" rel="noopener noreferrer">这篇</a>介绍的 Termux 部署个人网站，让这个网站可以在公网访问。如果你没有看过，可以先看一下。如果你有部署个人网站，或者其他需要通过公网访问的需求，也可以参考一下。</p><h2 id="开始实践" tabindex="-1"><a class="header-anchor" href="#开始实践"><span>开始实践</span></a></h2><h3 id="开启-ipv6" tabindex="-1"><a class="header-anchor" href="#开启-ipv6"><span>开启 IPV6</span></a></h3><h4 id="光猫和路由开启-ipv6" tabindex="-1"><a class="header-anchor" href="#光猫和路由开启-ipv6"><span>光猫和路由开启 IPV6</span></a></h4><p>现在的路由大多都是从光猫获取动态 IP，光猫和路由可能默认没有开启 IPV6，如果没有的话，需要在光猫和路由的后台开启 IPV6。</p><p>开启 IPV6 后还需要配置光猫和路由器的防火墙，一般默认情况下只允许出站流量，不允许入站流量，需要关闭防火墙。</p><p>不同型号的光猫和路由页面可能会有差异，这里不再展开。</p><h4 id="测试-ipv6" tabindex="-1"><a class="header-anchor" href="#测试-ipv6"><span>测试 IPV6</span></a></h4><p>当开启光猫和路由的 IPV6 后，连接 WiFi 的设备就可以获取到 IPV6 地址。当然这个 IPV6 地址也有可能是假公网 IPV6 地址，可以在 IPV6 测试网站进行测试，如：<a href="http://ipv6-test.ch/index.html.zh_CN" target="_blank" rel="noopener noreferrer">http://ipv6-test.ch/index.html.zh_CN</a></p><p>如果测试结果显示拥有公网 IPV6 地址，那么就可以继续，如果没有的话，就可以打住了。</p><p>下面是我这里的测试结果：</p><p><img src="'+r+`" alt=""></p><h4 id="termux-获取-ipv6" tabindex="-1"><a class="header-anchor" href="#termux-获取-ipv6"><span>Termux 获取 IPV6</span></a></h4><p>由于安卓手机的权限问题，尽管手机实际上已经获取了 IPV6 地址，但是在 Termux 中通过 ifconfig 查看还是只有 IPV4 地址。</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">~</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ifconfig</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Warning</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> cannot</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> open</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">proc</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">net</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">dev</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Permission</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> denied</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Limited</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> output</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">lo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> flags</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">73</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">UP</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">LOOPBACK</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">RUNNING</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  mtu</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 65536</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        inet</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 127.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.1</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  netmask</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 255.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.0</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        unspec</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  txqueuelen</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">  (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">UNSPEC</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">wlan0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> flags</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4163</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">UP</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">BROADCAST</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">RUNNING</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">MULTICAST</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  mtu</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1500</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        inet</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.103</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  netmask</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 255.255</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">255.0</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  broadcast</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.255</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        unspec</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">00</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  txqueuelen</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">  (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">UNSPEC</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,17)),t("p",null,[s[1]||(s[1]=a("因此如果要查看 IPV6 地址可以通过其他方式，")),l(n,{style:{color:"rgb(25, 27, 31)"}},{default:p(()=>s[0]||(s[0]=[a("运行以下指令，获取 ipv6 地址：")])),_:1})]),s[3]||(s[3]=i('<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://ipv6.ddnspod.com</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后在外网 ping 一下这个 IPV6 地址，看一下能不能 ping 通，如果能 ping 通，就基本成功一大半了，如果 ping 不通，就检查一下防火墙配置。</p><p>IPV6 ping 可以在这个网站进行测试：<a href="https://ipw.cn/ipv6ping/" target="_blank" rel="noopener noreferrer">https://ipw.cn/ipv6ping/</a>，下图是我这里的测试结果：</p><p><img src="'+g+'" alt=""></p><h3 id="ddns-配置" tabindex="-1"><a class="header-anchor" href="#ddns-配置"><span>DDNS 配置</span></a></h3><h4 id="域名配置" tabindex="-1"><a class="header-anchor" href="#域名配置"><span>域名配置</span></a></h4><p>获取到 IPV6 地址后，下一步就是将这个 IPV6 地址解析到我们指定的域名上，这里推荐一个专为 IPV6 提供免费域名和 DDNS 服务的网站：<a href="https://dynv6.com/" target="_blank" rel="noopener noreferrer">https://dynv6.com/</a></p><p>先去这个网站注册一下账号，这里就不演示了。</p><p>然后点击创建新的空间，选择一个域名，输入上一步获取的 IPV6 地址：</p><p><img src="'+c+'" alt=""></p><blockquote><p>dynv6 提供的免费域名为二级域名，有几个域名可选。三级域名，即我们创建的域名可以自行设置，不过一些可能已经被占用了。</p></blockquote><p>创建完成后就可以在<a href="https://ipw.cn/dns/" target="_blank" rel="noopener noreferrer">这里</a>验证一下解析是否正确：</p><p><img src="'+y+'" alt=""></p><h4 id="自动化更新-ipv6-地址" tabindex="-1"><a class="header-anchor" href="#自动化更新-ipv6-地址"><span>自动化更新 IPV6 地址</span></a></h4><p>IPV6 地址和 IPV4 地址一样，都是有地址租期的，到期之后可能发生变化，这时候我们就需要更新解析到域名上的 IPV6 地址，这就是 DDNS 的意思了。</p><p>在 dynv6 平台上，也是提供了相应的 API 接口，我们只要在 Termux 上运行一个定时任务，每隔一段时间检查一下 IPV6 地址是否发生变化，如果变化，调用 API 接口更新 IPV6 地址即可。</p><h5 id="添加-http-token" tabindex="-1"><a class="header-anchor" href="#添加-http-token"><span>添加 HTTP Token</span></a></h5><p>在 dynv6 右上角<code>账号</code>-&gt;<code>key</code>-&gt;<code>HTTP Tokens</code>选择添加新的 HTTP Token，取一个名字，选择空间，这里选择了上一步创建的域名，也可以选择 all，这样 Token 就对账号下的所有空间生效。</p><p><img src="'+A+'" alt=""></p><p>创建好的 Token 需要保存下来，也可以在 HTTP Tokens 里再次查看：</p><p><img src="'+o+`" alt=""></p><h5 id="termux-添加定时任务" tabindex="-1"><a class="header-anchor" href="#termux-添加定时任务"><span>Termux 添加定时任务</span></a></h5><p>按照 dynv6 平台的 API，写一个简单的 IPV6 更新脚本，这里命名为 <code>ipv6_update.sh</code>。</p><p>脚本里的执行间隔可以自行设置，空间要替换为自己的空间， TOKEN 需要替换为上一步获取的 HTTP Token。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">INTEREVAL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">60</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ZONE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">sunlight.dynv6.net</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">TOKEN</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">xxxxxxxxxxxxxxx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 将标准输出和标准错误重定向到日志文件</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">LOG_DIR</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">$PWD</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">LOG_FILE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ipv6_update.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">exec</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">LOG_DIR</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">LOG_FILE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> 2&gt;&amp;1</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">while</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> true</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">do</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  IPV6_ADDR</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --silent</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://ipv6.ddnspod.com</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  TIMESTAMP</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">date</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> +%Y-%m-%d_%H:%M:%S</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[$TIMESTAMP] IPV6 address: $IPV6_ADDR</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  curl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --silent</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">http://dynv6.com/api/update?zone=$ZONE&amp;token=$TOKEN&amp;ipv6=$IPV6_ADDR</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  sleep</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $INTEREVAL</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>赋予脚本可执行权限：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">~</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> $ chmod +777 ipv6_update.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>测试运行效果：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">~</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> $ ./ipv6_update.sh</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">2024-10-19_13:34:49</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> IPV6 address: 2409:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">addresses</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> updated</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到 dynv6 平台已经成功更新：</p><p><img src="`+B+`" alt=""></p><p>设置脚本开启自启动，编辑 <code>.bashrc</code> 文件，在其中添加如下内容：</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&amp;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> 后台运行</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ipv6_update</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sh</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意将脚本路径设置为实际路径，我这里把 <code>ipv6_update.sh</code> 脚本放在了 <code>.bashrc</code> 同一目录下。</p><p>此后每次启动 Termux 就会自动运行定时更新 IPV6 地址的脚本了，脚本日志在同目录下的 <code>ipv6_update.log</code> 文件里。</p><h3 id="nginx-配置-ipv6" tabindex="-1"><a class="header-anchor" href="#nginx-配置-ipv6"><span>Nginx 配置 IPV6</span></a></h3><p>现在我们有了域名，nginx 就可以开启域名和 IPV6 访问了。</p><p>编辑 <code>nginx.conf</code> 文件，在 server 中添加对于 IPV6 的 <code>listen</code>，并将 <code>server_name</code> 改为自己的域名。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">server</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        listen</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">       8080</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        listen</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">       [::]:8080</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        server_name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  sunlight.dynv6.net</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 其他配置</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启 nginx：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> reloag</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>在公网尝试使用域名访问 nginx，可以看到访问成功：</p><p><img src="`+v+'" alt=""></p><h3 id="url-转发" tabindex="-1"><a class="header-anchor" href="#url-转发"><span>URL 转发</span></a></h3><p>不过这里还有一点需要注意，运营商一般会将一些应用端口，比如 80、443 等封禁，不能用这些端口配置 nginx，这样就导致我们访问网站时还需要在域名后面加上具体的端口号，不够优雅。</p><p>dynv6 平台并未提供 URL 转发功能，目前我了解到，且可以进行 URL 转发的有阿里云的 DNS 解析：</p><p><img src="'+m+'" alt=""></p><p>将记录类型设置为隐性，记录值设置为 dynv6 平台的域名，不过这样还是需要自己有一个域名，而且被转发的域名需要进行备案，暂时没有更好的解决办法。</p>',48))])}const f=e(D,[["render",u]]),x=JSON.parse('{"path":"/article/deploy-personal-website-through-ddns-and-ipv6/","title":"通过 DDNS 和 IPV6 部署可公网访问的个人网站","lang":"zh-CN","frontmatter":{"title":"通过 DDNS 和 IPV6 部署可公网访问的个人网站","createTime":"2024/10/18 16:04:13","permalink":"/article/deploy-personal-website-through-ddns-and-ipv6/","excerpt":"写在前面如果想让局域网的个人网站能够在公网访问，就必须要公网地址，目前公网 IPV4 地址个人难以申请，但 IPV6 地址使用门槛就非常低，几乎都是支持的。本篇文章就接着这篇介绍的 Termux 部署个人网站，让这个网站可以在公网访问。如果你没有看过，可以先看一下。如果你有部署个人网站，或者其...","outline":[2,6],"tags":["IPV6","DDNS"],"description":"写在前面 如果想让局域网的个人网站能够在公网访问，就必须要公网地址，目前公网 IPV4 地址个人难以申请，但 IPV6 地址使用门槛就非常低，几乎都是支持的。 本篇文章就接着这篇介绍的 Termux 部署个人网站，让这个网站可以在公网访问。如果你没有看过，可以先看一下。如果你有部署个人网站，或者其他需要通过公网访问的需求，也可以参考一下。 开始实践 开...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"通过 DDNS 和 IPV6 部署可公网访问的个人网站\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-11-30T13:15:27.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://blog.ifback.com/article/deploy-personal-website-through-ddns-and-ipv6/"}],["meta",{"property":"og:site_name","content":"青何博客"}],["meta",{"property":"og:title","content":"通过 DDNS 和 IPV6 部署可公网访问的个人网站"}],["meta",{"property":"og:description","content":"写在前面 如果想让局域网的个人网站能够在公网访问，就必须要公网地址，目前公网 IPV4 地址个人难以申请，但 IPV6 地址使用门槛就非常低，几乎都是支持的。 本篇文章就接着这篇介绍的 Termux 部署个人网站，让这个网站可以在公网访问。如果你没有看过，可以先看一下。如果你有部署个人网站，或者其他需要通过公网访问的需求，也可以参考一下。 开始实践 开..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-30T13:15:27.000Z"}],["meta",{"property":"article:tag","content":"DDNS"}],["meta",{"property":"article:tag","content":"IPV6"}],["meta",{"property":"article:modified_time","content":"2024-11-30T13:15:27.000Z"}]]},"readingTime":{"minutes":6,"words":1800},"git":{"updatedTime":1732972527000,"contributors":[{"name":"SingleMoonlight","username":"SingleMoonlight","email":"winston.wyx@foxmail.com","commits":3,"avatar":"https://avatars.githubusercontent.com/SingleMoonlight?v=4","url":"https://github.com/SingleMoonlight"}]},"autoDesc":true,"filePathRelative":"编程/通过 DDNS 和 IPV6 部署可公网访问的个人网站.md","headers":[],"categoryList":[{"id":"41282b","sort":10007,"name":"编程"}]}');export{f as comp,x as data};
